# 微信退款步骤
## 一般微信退款处理步骤
* 发起退款申请
* 等待退款回调

## 完善的微信退款处理步骤
* 发起退款申请
* 等待退款回调
* 定时统计【已发起退款，但退款失败原因非余额不足，或者非过期的】的退款单，主动查询微信退款接口，更新退款单状态

# 申请退款注意事项
## 依赖API证书
> https://pay.weixin.qq.com/wiki/doc/api/jsapi.php?chapter=4_3

不带证书申请，微信会报443

## 对外退款单号不能重复使用，建议用 uuid，保证唯一
不要用业务内退款单号，因为业务各个环境规则一样，一样的退款单号会导致退款失败

## 微信退款限制
* 有次数限制，如果业务允许的话，不建议分成太多退款单去处理，最多不超50次
* 有时间限制，不能退超过1年的交易单

# 建议
* 记录失败退款原因
* 将退款失败原因至少归类2种
    * 如账号余额不足，并发问题导致退款失败，在程序上这一种可重新发起退款
    * 已超次数限制，已超时间限制，在程序上拒绝再次退款请求，转人工处理，手动更新退款状态即可